<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.chart.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<TabPane fx:id="adminTabPane"
         xmlns:fx="http://javafx.com/fxml"
         fx:controller="com.techway.coursemanagementdesktop.controller.admin.AdminDashboardController"
         prefWidth="1000" prefHeight="700"
         nodeOrientation="RIGHT_TO_LEFT"
         style="-fx-background-color: white; -fx-font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;">

    <tabs>
        <!-- تبويب لوحة التحكم -->
        <Tab fx:id="dashboardTab" text="لوحة التحكم" closable="false">
            <AnchorPane>

                <!-- الشريط العلوي -->
                <HBox AnchorPane.topAnchor="0" AnchorPane.leftAnchor="0" AnchorPane.rightAnchor="0"
                      prefHeight="60" style="-fx-background-color: #7E57C2;">
                    <children>
                        <Label text="لوحة تحكم المدير"
                               style="-fx-text-fill: white; -fx-font-size: 20px; -fx-font-weight: bold; -fx-padding: 15 0 0 20;"/>
                    </children>
                </HBox>

                <!-- البطاقات الإحصائية -->
                <HBox AnchorPane.topAnchor="70" AnchorPane.leftAnchor="20" spacing="20">
                    <children>
                        <!-- كل بطاقة -->
                        <VBox alignment="CENTER" spacing="8" prefWidth="180" prefHeight="100"
                              style="-fx-background-color: white; -fx-background-radius: 12; -fx-padding: 15;
                                     -fx-effect: dropshadow(gaussian, rgba(107,84,184,0.25),10,0,0,3);">
                            <Label fx:id="totalCoursesLabel" text="0"
                                   style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: #6b54b8;"/>
                            <Label text="إجمالي الكورسات" style="-fx-font-size: 14px; -fx-text-fill: #8e81c3;"/>
                        </VBox>

                        <VBox alignment="CENTER" spacing="8" prefWidth="180" prefHeight="100"
                              style="-fx-background-color: white; -fx-background-radius: 12; -fx-padding: 15;
                                     -fx-effect: dropshadow(gaussian, rgba(107,84,184,0.25),10,0,0,3);">
                            <Label fx:id="totalUsersLabel" text="0"
                                   style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: #6b54b8;"/>
                            <Label text="إجمالي المستخدمين" style="-fx-font-size: 14px; -fx-text-fill: #8e81c3;"/>
                        </VBox>

                        <VBox alignment="CENTER" spacing="8" prefWidth="180" prefHeight="100"
                              style="-fx-background-color: white; -fx-background-radius: 12; -fx-padding: 15;
                                     -fx-effect: dropshadow(gaussian, rgba(107,84,184,0.25),10,0,0,3);">
                            <Label fx:id="freeCoursesLabel" text="0"
                                   style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: #6b54b8;"/>
                            <Label text="الكورسات المجانية" style="-fx-font-size: 14px; -fx-text-fill: #8e81c3;"/>
                        </VBox>

                        <VBox alignment="CENTER" spacing="8" prefWidth="180" prefHeight="100"
                              style="-fx-background-color: white; -fx-background-radius: 12; -fx-padding: 15;
                                     -fx-effect: dropshadow(gaussian, rgba(107,84,184,0.25),10,0,0,3);">
                            <Label fx:id="paidCoursesLabel" text="0"
                                   style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: #6b54b8;"/>
                            <Label text="الكورسات المدفوعة" style="-fx-font-size: 14px; -fx-text-fill: #8e81c3;"/>
                        </VBox>

                        <VBox alignment="CENTER" spacing="8" prefWidth="180" prefHeight="100"
                              style="-fx-background-color: white; -fx-background-radius: 12; -fx-padding: 15;
                                     -fx-effect: dropshadow(gaussian, rgba(107,84,184,0.25),10,0,0,3);">
                            <Label fx:id="totalRevenueLabel" text="0"
                                   style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: #6b54b8;"/>
                            <Label text="إجمالي الإيرادات" style="-fx-font-size: 14px; -fx-text-fill: #8e81c3;"/>
                        </VBox>

                        <VBox alignment="CENTER" spacing="8" prefWidth="180" prefHeight="100"
                              style="-fx-background-color: white; -fx-background-radius: 12; -fx-padding: 15;
                                     -fx-effect: dropshadow(gaussian, rgba(107,84,184,0.25),10,0,0,3);">
                            <Label fx:id="newEnrollmentsLabel" text="0"
                                   style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: #6b54b8;"/>
                            <Label text="التسجيلات خلال 30 يوم" style="-fx-font-size: 14px; -fx-text-fill: #8e81c3;"/>
                        </VBox>
                    </children>
                </HBox>

                <!-- المحتوى الرئيسي القابل للتمرير -->
                <ScrollPane AnchorPane.topAnchor="190" AnchorPane.leftAnchor="20" AnchorPane.rightAnchor="20" AnchorPane.bottomAnchor="20"
                            fitToWidth="true" fitToHeight="true" hbarPolicy="NEVER" vbarPolicy="AS_NEEDED">
                    <content>
                        <VBox spacing="20" alignment="TOP_CENTER" fillWidth="true" style="-fx-padding: 10;">

                            <!-- TableView يملأ العرض -->
                            <TableView fx:id="topCoursesTable"
                                       VBox.vgrow="NEVER"
                                       maxWidth="Infinity"
                                       prefHeight="1000"
                                       style="-fx-font-family: 'Segoe UI'; -fx-font-size: 14px; -fx-background-color: white; -fx-border-color: #ddd; -fx-border-width: 1;">
                                <columns>
                                    <TableColumn fx:id="topCourseIdColumn" text="معرف الدورة" prefWidth="100"/>
                                    <TableColumn fx:id="topCourseStatusColumn" text="الحالة" prefWidth="100"/>
                                    <TableColumn fx:id="topCourseRevenueColumn" text="الإيراد" prefWidth="150"/>
                                    <TableColumn fx:id="topCourseStudentsColumn" text="الطلاب" prefWidth="100"/>
                                    <TableColumn fx:id="topCourseTitleColumn" text="الكورس" prefWidth="350"/>
                                </columns>
                                <columnResizePolicy>
                                    <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
                                </columnResizePolicy>
                            </TableView>

                            <!-- Performance Overview -->
                            <HBox alignment="CENTER_RIGHT" spacing="10">
                                <Label text="Performance Overview" style="-fx-font-size: 16px; -fx-font-weight: bold;"/>
                                <Label fx:id="subtitleLabel" text="تسجيلات آخر 30 يوم" style="-fx-font-size: 12px; -fx-text-fill: #666;"/>
                                <Region HBox.hgrow="ALWAYS"/>
                                <ComboBox fx:id="rangeComboBox" prefWidth="150"/>
                                <Button text="تحديث" fx:id="refreshButton"
                                        style="-fx-background-color: #4c1d95; -fx-text-fill: white; -fx-background-radius: 8;"/>
                            </HBox>

                            <!-- Line Chart -->
                            <LineChart fx:id="enrollmentsChart" prefHeight="300" prefWidth="900" animated="true" createSymbols="true">
                                <xAxis>
                                    <CategoryAxis label="التاريخ"/>
                                </xAxis>
                                <yAxis>
                                    <NumberAxis label="عدد التسجيلات"/>
                                </yAxis>
                            </LineChart>

                            <!-- Recent Activity and Courses -->
                            <HBox spacing="20" alignment="TOP_CENTER">
                                <!-- Recent Activity -->
                                <VBox spacing="10" prefWidth="460">
                                    <HBox spacing="10" alignment="CENTER_LEFT">
                                        <Label text="Recent Activity" styleClass="title-label"/>
                                        <Region HBox.hgrow="ALWAYS"/> <!-- يفصل بين العنوان والزر -->
                                        <Button text="تحديث" fx:id="refreshBtn"
                                                style="-fx-background-color: #4c1d95; -fx-text-fill: white; -fx-background-radius: 8;"/>
                                    </HBox>

                                    <ListView fx:id="activityList" prefHeight="300" VBox.vgrow="ALWAYS"/>
                                </VBox>

                                <!-- Recent Courses -->
                                <!-- Recent Courses -->
                                <VBox spacing="10" prefWidth="460">
                                    <HBox spacing="10" alignment="CENTER_LEFT">
                                        <Label text="Recent Courses" styleClass="title-label"/>
                                        <Region HBox.hgrow="ALWAYS"/>
                                        <Button text="تحديث" fx:id="refreshCoursesBtn"
                                                style="-fx-background-color: #4c1d95; -fx-text-fill: white; -fx-background-radius: 8;"/>
                                    </HBox>

                                    <ScrollPane fitToWidth="true" prefHeight="300" vbarPolicy="AS_NEEDED">
                                        <content>
                                            <ListView fx:id="recentCoursesList" prefHeight="300"/>
                                        </content>
                                    </ScrollPane>
                                </VBox>
                            </HBox>

                        </VBox>
                    </content>
                </ScrollPane>

            </AnchorPane>
        </Tab>

        <!-- تبويب الكورسات -->
        <Tab fx:id="coursesTab" text="الكورسات" closable="false">
            <AnchorPane>
                <HBox spacing="10" layoutX="20" layoutY="10">
                    <Button fx:id="addCourseButton" text="➕ إضافة كورس" onAction="#showAddCourseDialog"
                            style="-fx-background-color: #4c1d95; -fx-text-fill: white; -fx-background-radius: 8;" />
                    <Button fx:id="editCourseButton" text="✏️ تعديل" onAction="#showEditCourseDialog"
                            style="-fx-background-color: #4c1d95; -fx-text-fill: white; -fx-background-radius: 8;" />
                    <Button fx:id="deleteCourseButton" text="🗑️ حذف" onAction="#deleteSelectedCourse"
                            style="-fx-background-color: #4c1d95; -fx-text-fill: white; -fx-background-radius: 8;" />

                </HBox>

                <TableView fx:id="coursesTable" AnchorPane.topAnchor="50" AnchorPane.leftAnchor="20" AnchorPane.rightAnchor="20" AnchorPane.bottomAnchor="20"  style="-fx-font-family: 'Segoe UI'; -fx-font-size: 14px; -fx-background-color: white; -fx-border-color: #ddd; -fx-border-width: 1;">
                    <columns>
                        <TableColumn fx:id="idColumn" text="ID" prefWidth="100"/>
                        <TableColumn fx:id="titleColumn" text="العنوان" prefWidth="300"/>
                        <TableColumn fx:id="statusColumn" text="الحالة" prefWidth="150"/>
                        <TableColumn fx:id="priceColumn" text="السعر" prefWidth="150"/>
                    </columns>
                </TableView>
            </AnchorPane>
        </Tab>



        <!-- تبويب المستخدمين -->
        <Tab fx:id="usersTab" text="المستخدمين" closable="false">
            <AnchorPane>
                <TableView fx:id="usersTable" prefWidth="950" prefHeight="600" layoutX="20" layoutY="20">
                    <columns>
                        <TableColumn fx:id="userIdColumn" text="ID" prefWidth="100"/>
                        <TableColumn fx:id="userNameColumn" text="الاسم" prefWidth="250"/>
                        <TableColumn fx:id="userEmailColumn" text="البريد الإلكتروني" prefWidth="250"/>
                        <TableColumn fx:id="userRoleColumn" text="الصلاحية" prefWidth="150"/>
                    </columns>
                </TableView>
            </AnchorPane>
        </Tab>

        <!-- تبويب الإعدادات -->
        <Tab fx:id="settingsTab" text="الإعدادات" closable="false">
            <AnchorPane>
                <Label text="⚙️ إعدادات النظام" layoutX="50" layoutY="50"
                       style="-fx-font-size: 20px; -fx-font-weight: bold;"/>
            </AnchorPane>
        </Tab>

    </tabs>
</TabPane>
